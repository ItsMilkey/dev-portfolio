---

---

<header
    id="main-header"
    class="fixed top-0 left-0 w-full z-50 transition-all duration-500"
>
    <!-- Top Bar Layout -->
    <nav
        id="top-nav"
        class="max-w-[1200px] mx-auto px-6 py-4 flex justify-between items-center bg-cream/80 backdrop-blur-md md:bg-transparent md:backdrop-blur-none transition-all duration-300"
    >
        <a
            href="#"
            class="font-display font-bold text-theme-primary text-xl uppercase tracking-widest hover-accent transition-colors"
        >
            HG
        </a>

        <!-- Desktop Menu -->
        <div class="hidden md:flex items-center gap-8">
            <a
                href="#projects"
                class="text-theme-primary font-sans text-sm tracking-wide hover-accent transition-colors"
                >PROJECTS</a
            >
            <a
                href="#about"
                class="text-theme-primary font-sans text-sm tracking-wide hover-accent transition-colors"
                >ABOUT</a
            >
            <a
                href="#skills"
                class="text-theme-primary font-sans text-sm tracking-wide hover-accent transition-colors"
                >TECH STACK</a
            >

            <!-- Theme Toggle (Functional) -->
            <button
                onclick="toggleTheme()"
                class="w-10 h-5 rounded-full relative cursor-pointer hover:opacity-80 transition-all theme-toggle-switch"
                aria-label="Toggle Theme"
                style="background-color: var(--color-toggle-bg);"
            >
                <div
                    class="absolute top-0.5 left-0.5 w-4 h-4 rounded-full transition-transform duration-300 theme-toggle-indicator"
                    style="transform: translateX(2px); background-color: var(--color-toggle-indicator);"
                >
                </div>
            </button>
        </div>
    </nav>

    <!-- Floating Burger Menu (Hidden initially) -->
    <div
        id="floating-menu-container"
        class="fixed top-6 right-6 translate-x-[200%] transition-transform duration-500 z-50"
    >
        <button
            id="menu-btn"
            class="w-12 h-12 bg-forest text-cream rounded-full shadow-lg flex items-center justify-center hover:bg-vibrant-orange hover:text-forest transition-colors relative z-50"
        >
            <!-- Hamburger Icon -->
            <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-6 h-6"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 6h16M4 12h16m-7 6h7"></path>
            </svg>
        </button>

        <!-- Dropdown Menu -->
        <div
            id="dropdown-menu"
            class="absolute top-16 right-0 w-64 bg-theme-secondary border border-cream/10 rounded-xl shadow-2xl p-6 flex flex-col gap-5 opacity-0 pointer-events-none scale-95 transition-all duration-300 origin-top-right"
        >
            <a
                href="#"
                class="text-cream hover:text-vibrant-orange font-sans text-base font-medium transition-colors"
                >Home</a
            >
            <a
                href="#projects"
                class="text-cream hover:text-vibrant-orange font-sans text-base font-medium transition-colors"
                >Projects</a
            >
            <a
                href="#about"
                class="text-cream hover:text-vibrant-orange font-sans text-base font-medium transition-colors"
                >About</a
            >
            <a
                href="#skills"
                class="text-cream hover:text-vibrant-orange font-sans text-base font-medium transition-colors"
                >Tech Stack</a
            >
            <!-- Mobile Theme Toggle (Functional) -->
            <div
                class="flex items-center justify-between text-cream/70 text-sm pt-3 border-t border-cream/10"
            >
                <span>Theme</span>
                <button
                    onclick="toggleTheme()"
                    class="w-10 h-5 rounded-full relative cursor-pointer hover:opacity-80 transition-all theme-toggle-switch"
                    aria-label="Toggle Theme"
                    style="background-color: var(--color-toggle-bg);"
                >
                    <div
                        class="absolute top-0.5 left-0.5 w-4 h-4 rounded-full transition-transform duration-300 theme-toggle-indicator"
                        style="transform: translateX(2px); background-color: var(--color-accent);"
                    >
                    </div>
                </button>
            </div>
        </div>
    </div>
</header>

<script>
    const header = document.getElementById("main-header");
    const topNav = document.getElementById("top-nav");
    const floatingContainer = document.getElementById(
        "floating-menu-container",
    );
    const menuBtn = document.getElementById("menu-btn");
    const dropdownMenu = document.getElementById("dropdown-menu");

    // Scroll Logic
    window.addEventListener("scroll", () => {
        if (!topNav || !floatingContainer || !dropdownMenu) return;

        if (window.scrollY > 150) {
            // Hide Top Bar
            topNav.classList.add("-translate-y-full", "opacity-0");
            // Show Floating Button
            floatingContainer.classList.remove("translate-x-[200%]");
            // Update button color based on background
            updateFloatingMenuColor();
        } else {
            // Show Top Bar
            topNav.classList.remove("-translate-y-full", "opacity-0");
            // Hide Floating Button & Close Menu
            floatingContainer.classList.add("translate-x-[200%]");
            dropdownMenu.classList.add(
                "opacity-0",
                "pointer-events-none",
                "scale-95",
            );
        }
    });

    // Function to detect background color and update menu styling
    function updateFloatingMenuColor() {
        if (!menuBtn || !floatingContainer) return;

        // Get the position of the floating button
        const rect = floatingContainer.getBoundingClientRect();
        const x = rect.left + rect.width / 2;
        const y = rect.top + rect.height / 2;

        // Get the element at that position
        floatingContainer.style.pointerEvents = "none";
        const elementBelow = document.elementFromPoint(x, y);
        floatingContainer.style.pointerEvents = "auto";

        if (!elementBelow) return;

        // Get effective background color (traverse up if transparent)
        const bgColor = getEffectiveBackgroundColor(elementBelow);

        // Check if background is dark
        const isDarkBackground = isColorDark(bgColor);

        // Get current theme state
        const currentTheme =
            document.documentElement.getAttribute("data-theme") || "light";

        // Define contrast colors relative to the theme
        // Dark Theme: Primary BG is Dark (#1a1a1f), Text is Light (#e8e8f0)
        // Light Theme: Primary BG is Light (#F5F1E3), Text is Dark (#2D3E2F)

        // If we are over a DARK background, we need a LIGHT button.
        // If we are over a LIGHT background, we need a DARK button.

        let btnBg, btnText;

        if (isDarkBackground) {
            // Need LIGHT button
            // In Dark Theme, TextPrimary is Light. In Light Theme, BgPrimary is Light.
            if (currentTheme === "dark") {
                // Use Theme Light Text Color (Grayish White)
                btnBg = "#e8e8f0";
                btnText = "#1a1a1f";
            } else {
                // Use Theme Background Color (Cream)
                btnBg = "#F5F1E3";
                btnText = "#2D3E2F";
            }
        } else {
            // Need DARK button
            // In Dark Theme, BgPrimary is Dark. In Light Theme, TextPrimary is Dark.
            if (currentTheme === "dark") {
                // Use Theme Background Color (Dark Gray)
                btnBg = "#1a1a1f";
                btnText = "#e8e8f0";
            } else {
                // Use Theme Text Color (Forest)
                btnBg = "#2D3E2F";
                btnText = "#F5F1E3";
            }
        }

        menuBtn.style.backgroundColor = btnBg;
        menuBtn.style.color = btnText;
    }

    // Helper to get effective background color by traversing up
    function getEffectiveBackgroundColor(element: Element | null): string {
        if (!element) return "rgba(0, 0, 0, 0)";

        const style = window.getComputedStyle(element);
        const bgColor = style.backgroundColor;

        // Check if color is transparent or not set
        if (
            !bgColor ||
            bgColor === "transparent" ||
            bgColor === "rgba(0, 0, 0, 0)"
        ) {
            // If we reached the body/html and it's still transparent, return the theme background
            if (element.tagName === "BODY" || element.tagName === "HTML") {
                // Fallback to checking the calculated theme background
                return getComputedStyle(document.body).backgroundColor;
            }
            // Traverse up
            if (element.parentElement) {
                return getEffectiveBackgroundColor(element.parentElement);
            }
        }

        return bgColor;
    }

    // Helper function to determine if a color is dark
    function isColorDark(color: string): boolean {
        // Handle transparent or empty
        if (!color || color === "transparent" || color === "rgba(0, 0, 0, 0)")
            return false;

        const rgb = color.match(/\d+/g);
        if (!rgb || rgb.length < 3) return false;

        const r = parseInt(rgb[0]);
        const g = parseInt(rgb[1]);
        const b = parseInt(rgb[2]);

        // Calculate relative luminance
        const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;

        // Consider dark if luminance is less than 0.5
        return luminance < 0.5;
    }

    // Listen for theme changes to update button color immediately
    const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
            if (mutation.attributeName === "data-theme") {
                updateFloatingMenuColor();
            }
        });
    });
    observer.observe(document.documentElement, { attributes: true });

    // Toggle Menu
    menuBtn?.addEventListener("click", () => {
        if (!dropdownMenu) return;
        dropdownMenu.classList.toggle("opacity-0");
        dropdownMenu.classList.toggle("pointer-events-none");
        dropdownMenu.classList.toggle("scale-95");
    });

    // Close menu when clicking links
    dropdownMenu?.querySelectorAll("a").forEach((link) => {
        link.addEventListener("click", () => {
            if (!dropdownMenu) return;
            dropdownMenu.classList.add(
                "opacity-0",
                "pointer-events-none",
                "scale-95",
            );
        });
    });
</script>
